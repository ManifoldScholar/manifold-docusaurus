"use strict";(self.webpackChunkmanifold_docusaurus=self.webpackChunkmanifold_docusaurus||[]).push([[5546],{44401:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>M,contentTitle:()=>w,default:()=>S,frontMatter:()=>v,metadata:()=>y,toc:()=>I});var a=s(74848),i=s(28453),l=s(11470),t=s(19365),o=(s(96540),s(58156)),r=s.n(o),c=s(4784);const d=s(87507),{customFields:h}=c.default,u=h.data;function m(e,n){if(!e||!n)return null;return u.releases[e][n]}function p(e){if(!e)return null;const n=u.releases[e];if(!n)return null;return g(Object.keys(n))}function f(e){if(!e)return null;const n=u.releases[e];if(!n)return null;return g(Object.keys(n).filter((e=>!e.includes("-alpha")&&!e.includes("-beta")&&!e.includes("-rc"))))}function g(e){return function(e){return d(e)}(e).slice(-1)[0]||null}function x(e){return e?e.startsWith("v")?e:`v${e}`:null}function j(e,n){if("path"===e)return r()(u,n);if("highestVersionFor"===e)return x(p(n));if("highestStableVersionFor"===e)return x(f(n));if("installUrlFor"===e){return m(n,f(n)).url}if("prereleaseStatement"===e)return f(n)==p(n)?null:(0,a.jsxs)("span",{children:["There is also currently a pre-release version of Manifold,"," ",(0,a.jsx)("strong",{children:p(n)}),","," ","which we encourage you to test."," "]});if("basenameFor"===e){return m(n,f(n)).basename}return null}function b(e){let{command:n,argument:s}=e;return j(n,s)}var k=s(21432);const v={id:"installation",title:"Installation",sidebar_label:"Installation"},w=void 0,y={id:"administering/installation",title:"Installation",description:"Install Strategies",source:"@site/docs/administering/installation.md",sourceDirName:"administering",slug:"/administering/installation",permalink:"/manifold-docusaurus/docs/administering/installation",draft:!1,unlisted:!1,editUrl:"https://github.com/ManifoldScholar/manifold-docusaurus/edit/master/docs/administering/installation.md",tags:[],version:"current",frontMatter:{id:"installation",title:"Installation",sidebar_label:"Installation"},sidebar:"docs",previous:{title:"Hosting",permalink:"/manifold-docusaurus/docs/administering/hosting"},next:{title:"Upgrading",permalink:"/manifold-docusaurus/docs/administering/upgrading"}},M={},I=[{value:"Install Strategies",id:"install-strategies",level:2},{value:"Install Instructions",id:"install-instructions",level:2},{value:"Package Install",id:"package-install",level:3},{value:"1. Download the Package",id:"1-download-the-package",level:4},{value:"2. Install the Package",id:"2-install-the-package",level:4},{value:"3. Apply Minimal Configuration",id:"3-apply-minimal-configuration",level:4},{value:"4. Access the Backend",id:"4-access-the-backend",level:4},{value:"Docker Install",id:"docker-install",level:3},{value:"Source Install",id:"source-install",level:3}];function A(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"install-strategies",children:"Install Strategies"}),"\n",(0,a.jsx)(n.p,{children:"We offer three installation strategies for Manifold:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Install from OS ",(0,a.jsx)(n.strong,{children:"package"})]}),"\n",(0,a.jsxs)(n.li,{children:["Install with ",(0,a.jsx)(n.strong,{children:"Docker"})," images"]}),"\n",(0,a.jsxs)(n.li,{children:["Install from ",(0,a.jsx)(n.strong,{children:"source"})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"For package installations, we distribute packages for Ubuntu (18.x and 20.x) and Redhat/CentOS (el7 and el8). The package will install and configure every service needed to run Manifold. You will need root access to the host in order to install Manifold from these packages. This is the fastest, easiest way to install Manifold, but it also is the most intrusive and gives you the least control over the installation. That said, for users who are not familiar with the Manifold technology stack (Rails, Node, ElasticSearch, PostgreSQL, Redis, and Nginx), package installation will be the fastest and simplest approach."}),"\n",(0,a.jsx)(n.p,{children:"When Manifold is installed using Docker, each service runs in its own Docker container and the services are coordinated using Docker compose."}),"\n",(0,a.jsx)(n.p,{children:"We're still working on documentation for installing Manifold from source. For now, this is not an officially supported installation method, but we hope to provide guidance soon."}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["Manifold is a new piece of software, and we're working hard to refine and improve the installation process. If you run into problems, please don't get frustrated. Let us know in Slack (",(0,a.jsx)(n.a,{href:"https://manifold-slackin.herokuapp.com/",children:"join here"}),") or ",(0,a.jsx)(n.a,{href:"https://github.com/ManifoldScholar/manifold/issues/new?template=bugs.md",children:"report an issue"}),". It's very important to us that Manifold be easy to install, and we appreciate your help as we improve this process."]})}),"\n",(0,a.jsx)(n.h2,{id:"install-instructions",children:"Install Instructions"}),"\n",(0,a.jsx)(n.p,{children:"Select the strategy that makes sense for your organization to see the corresponding instructions."}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["The current stable Manifold version is ",(0,a.jsx)("strong",{children:(0,a.jsx)(b,{command:"highestStableVersionFor",argument:"ubuntu22"})}),". ",(0,a.jsx)(b,{command:"prereleaseStatement",argument:"ubuntu22"}),"All releases can be downloaded from the ",(0,a.jsx)(n.a,{href:"/docs/administering/reference/downloads",children:"downloads page"}),"."]})}),"\n",(0,a.jsx)(n.h3,{id:"package-install",children:"Package Install"}),"\n",(0,a.jsxs)(n.p,{children:["The most recent version of Manifold is ",(0,a.jsx)(b,{command:"highestStableVersionFor",argument:"ubuntu22"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Support for Ubuntu16 was discontinued with the release of Manifold v6. Support for Ubuntu18 was discontinued with the release of Manifold v8."}),"\n",(0,a.jsx)(n.h4,{id:"1-download-the-package",children:"1. Download the Package"}),"\n",(0,a.jsx)(n.p,{children:"Shell into the server as root and download the most recent package."}),"\n",(0,a.jsxs)(l.A,{groupId:"install-type",defaultValue:"ubuntu22",values:[{label:"Ubuntu22",value:"ubuntu22"},{label:"Ubuntu20",value:"ubuntu20"},{label:"CentOS 8",value:"centos8"},{label:"CentOS 7",value:"centos7"}],children:[(0,a.jsx)(t.A,{value:"ubuntu22",children:(0,a.jsx)(k.A,{className:"shell",children:`\ncd ~\ncurl -O ${j("installUrlFor","ubuntu22")}\n  `.trim()})}),(0,a.jsx)(t.A,{value:"ubuntu20",children:(0,a.jsx)(k.A,{className:"shell",children:`\ncd ~\ncurl -O ${j("installUrlFor","ubuntu20")}\n  `.trim()})}),(0,a.jsx)(t.A,{value:"centos8",children:(0,a.jsx)(k.A,{className:"shell",children:`\ncd ~\ncurl -O ${j("installUrlFor","centos8")}\n  `.trim()})}),(0,a.jsx)(t.A,{value:"centos7",children:(0,a.jsx)(k.A,{className:"shell",children:`\ncd ~\ncurl -O ${j("installUrlFor","centos7")}\n  `.trim()})})]}),"\n",(0,a.jsx)(n.h4,{id:"2-install-the-package",children:"2. Install the Package"}),"\n",(0,a.jsxs)(l.A,{groupId:"install-type",defaultValue:"ubuntu22",values:[{label:"Ubuntu22",value:"ubuntu22"},{label:"Ubuntu20",value:"ubuntu20"},{label:"CentOS 8",value:"centos8"},{label:"CentOS 7",value:"centos7"}],children:[(0,a.jsx)(t.A,{value:"ubuntu22",children:(0,a.jsx)(k.A,{className:"shell",children:`\ncd ~\ndpkg -i ${j("basenameFor","ubuntu22")}\n  `.trim()})}),(0,a.jsx)(t.A,{value:"ubuntu20",children:(0,a.jsx)(k.A,{className:"shell",children:`\ncd ~\ndpkg -i ${j("basenameFor","ubuntu20")}\n  `.trim()})}),(0,a.jsx)(t.A,{value:"centos8",children:(0,a.jsx)(k.A,{className:"shell",children:`\ncd ~\nrpm -ivh ${j("basenameFor","centos8")}\n  `.trim()})}),(0,a.jsx)(t.A,{value:"centos7",children:(0,a.jsx)(k.A,{className:"shell",children:`\ncd ~\nrpm -ivh ${j("basenameFor","centos7")}\n  `.trim()})})]}),"\n",(0,a.jsx)(n.h4,{id:"3-apply-minimal-configuration",children:"3. Apply Minimal Configuration"}),"\n",(0,a.jsxs)(n.p,{children:["The package installer creates a file at ",(0,a.jsx)(n.code,{children:"/etc/manifold/manifold.rb"}),". Use this file to configure and manage the various services that Manifold is composed of. After changing this file, you\u2019ll need to run sudo manifold-ctl reconfigure from the command line so that Manifold picks up the changes and regenerates various configuration files based on the new settings."]}),"\n",(0,a.jsxs)(n.p,{children:["For now, let\u2019s just make sure Manifold is on the right domain. Open ",(0,a.jsx)(n.code,{children:"/etc/manifold/manifold.rb"})," in your preferred text editor (nano, vi, etc.) and look for the external_url setting near the top of the file. Set this to the fully qualified domain name of your Manifold installation, then reconfigure Manifold with the following command. You may be prompted to accept the license. You can scroll through the licenses by pressing space, or \u201cq\u201d to exit the license view. You will need to accept the licenses before proceeding with the installation."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"/usr/bin/manifold-ctl reconfigure\n/usr/bin/manifold-ctl restart\n"})}),"\n",(0,a.jsx)(n.p,{children:"Once this process is complete and you've restarted Manifold, visit the fully qualified domain name in your browser. You should see an empty Manifold home page."}),"\n",(0,a.jsx)(n.h4,{id:"4-access-the-backend",children:"4. Access the Backend"}),"\n",(0,a.jsxs)(n.p,{children:["All content stored in Manifold\u2014texts, projects, authors, resources, users, etc\u2014is managed through Manifold\u2019s backend interface. The backend is available at the ",(0,a.jsx)(n.code,{children:"/backend"})," path. For example, if your domain name was your-manifold-domain.tld, you\u2019d access the backend at ",(0,a.jsx)(n.code,{children:"http://your-manifold-domain.tld/backend"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Before you can login to the backend, you will need to make an administrative user. Manifold exposes Rake commands provided by the API Rails application by way of a ",(0,a.jsx)(n.code,{children:"manifold-api"})," executable located at ",(0,a.jsx)(n.code,{children:"/usr/local/bin/manifold-api"}),". This executable includes a command for creating an admin user. Call this command as follows:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'sudo manifold-api manifold:user:create:admin["you@email.com","password","firstName","lastName"]\n'})}),"\n",(0,a.jsx)(n.p,{children:"Substitute your email, password, first and last into the command above. If the command succeed, Manifold will let you know. For example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'manifold@manifold-deb:/etc/manifold# sudo manifold-api manifold:user:create:admin["john@milton.com","Lycidas","John","Milton"]\n    INFO: A User has been created. Its ID is 9b8c863f-60cd-44aa-ad99-dbb842e51aa2\n'})}),"\n",(0,a.jsx)(n.p,{children:"Once you\u2019ve created an admin user, click on the avatar icon in the top right corner of the Manifold frontend to login. After logging in successfully, you will see an \u201cadmin mode\u201d button in the header. Click the admin mode button to access the backend."}),"\n",(0,a.jsx)(n.h3,{id:"docker-install",children:"Docker Install"}),"\n",(0,a.jsxs)(n.p,{children:["Starting with version 4.0, we publish Docker images alongside our OS packages.\nThese images are published under the ",(0,a.jsx)(n.a,{href:"https://hub.docker.com/u/manifoldscholarship",children:"manifoldscholarship"}),"\norganization on hub.docker.com. The Manifold team is happy to accept pull\nrequests and are open to suggestions as to how we can improve our Docker support."]}),"\n",(0,a.jsxs)(n.p,{children:["The following instructions assume that you've intalled docker and can run both\n",(0,a.jsx)(n.code,{children:"docker"})," and ",(0,a.jsx)(n.code,{children:"docker-compose"})," from the command line."]}),"\n",(0,a.jsx)(n.p,{children:"To begin running Manifold on Docker, clone our docker-compose repository:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"git clone https://github.com/ManifoldScholar/manifold-docker-compose.git\n"})}),"\n",(0,a.jsx)(n.p,{children:"The docker-compose.yml file in this repository includes all the services that\nManifold needs to run. For more complex deployments, feel free to use this files\nas a starting point and modify as needed."}),"\n",(0,a.jsx)(n.p,{children:"Before spinning up the containers, modify environment/manifold.env so that it\ncontains the correct IP or domain name for your server. Unless you're just running\nthese locally, you'll need to replace 127.0.0.1 from the following env vars:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'DOMAIN="127.0.0.1:4000"\nCLIENT_BROWSER_API_URL="http://127.0.0.1:4000"\nCLIENT_BROWSER_API_CABLE_URL="http://127.0.0.1:4000/cable"\n'})}),"\n",(0,a.jsx)(n.p,{children:"From within that git repository, create and start Manifold containers:"}),"\n",(0,a.jsx)("div",{style:{marginBottom:"var(--ifm-leading)"},children:(0,a.jsx)(k.A,{className:"shell",children:`\nMANIFOLD_TAG=${j("path","manifoldVersion")} docker-compose up -d\n`.trim()})}),"\n",(0,a.jsx)("p",{children:"Access the site in your browser. Be patient, as it might take a minute for\nservices to start."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"http://127.0.0.1:4000\n"})}),"\n",(0,a.jsx)(n.p,{children:"Tail container log output (ctrl + c to stop)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"docker-compose logs -f\n"})}),"\n",(0,a.jsx)(n.p,{children:"Restart Manifold containers"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"docker-compose restart\n"})}),"\n",(0,a.jsx)(n.p,{children:"Stop Manifold containers"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"docker-compose stop\n"})}),"\n",(0,a.jsx)(n.p,{children:"Stop and remove Manifold containers"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"docker-compose down\n"})}),"\n",(0,a.jsx)(n.p,{children:"Access the Rails (Manifold API Backend) console"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"docker exec -it  manifold-docker-compose_api_rails_1 rails console\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Replace ",(0,a.jsx)(n.code,{children:"console"})," in the above command with other Manifold rake commands. These\ncommands are the same commands that are available in the Omnibus packages, and\nare ",(0,a.jsx)(n.a,{href:"/docs/administering/reference/api_rake_tasks",children:"documented here"})]}),"\n",(0,a.jsx)(n.p,{children:"Create an admin user"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"docker exec -it manifold-docker-compose_api_rails_1 \\\nrails manifold:user:create:admin['email@example.com','test123!','First','Last']\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.em,{children:["With some terminal configurations don't forget to escape ",(0,a.jsx)(n.code,{children:"["})," and ",(0,a.jsx)(n.code,{children:"]"})," like ",(0,a.jsx)(n.code,{children:"\\["}),"."]})}),"\n",(0,a.jsx)(n.h3,{id:"source-install",children:"Source Install"}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"This section is still a work in progress. Check back soon for instructions on installing from source."})})]})}function S(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(A,{...e})}):A(e)}}}]);