"use strict";(self.webpackChunkmanifold_docusaurus=self.webpackChunkmanifold_docusaurus||[]).push([[108],{55183:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var a=i(74848),t=i(28453);const s={id:"upgrading",title:"Upgrading",sidebar_label:"Upgrading"},o=void 0,r={id:"administering/upgrading",title:"Upgrading",description:"Overview",source:"@site/docs/administering/upgrading.md",sourceDirName:"administering",slug:"/administering/upgrading",permalink:"/manifold-docusaurus/docs/administering/upgrading",draft:!1,unlisted:!1,editUrl:"https://github.com/ManifoldScholar/manifold-docusaurus/edit/master/docs/administering/upgrading.md",tags:[],version:"current",frontMatter:{id:"upgrading",title:"Upgrading",sidebar_label:"Upgrading"},sidebar:"docs",previous:{title:"Installation",permalink:"/manifold-docusaurus/docs/administering/installation"},next:{title:"v8.x",permalink:"/manifold-docusaurus/docs/administering/release_notes/v8x"}},l={},d=[{value:"Overview",id:"overview",level:2},{value:"Database Migrations",id:"database-migrations",level:3},{value:"System Upgrades",id:"system-upgrades",level:3},{value:"Upgrade Instructions",id:"upgrade-instructions",level:2},{value:"For a Package install",id:"for-a-package-install",level:3},{value:"For a Docker install",id:"for-a-docker-install",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(n.p,{children:"There are a number of steps involved in updating Manifold from one version to another, and the steps vary depending on how you installed Manifold. Be sure to consult the appropriate section below based on your installation type."}),"\n",(0,a.jsx)(n.h3,{id:"database-migrations",children:"Database Migrations"}),"\n",(0,a.jsx)(n.p,{children:'New versions of Manifold will often include changes to the structure of the PostgreSQL database. These changes are called "migrations," and we leverage the Rails migration subsystem for managing these changes. Manifold\'s API (a Rails application) is the only component that is able to access the database directly, and it is responsible for running migrations. See below for specific instructions on how to view the current migration state and run migrations in your environment.'}),"\n",(0,a.jsx)(n.h3,{id:"system-upgrades",children:"System Upgrades"}),"\n",(0,a.jsxs)(n.p,{children:["There are some data transformations that cannot be performed as database migrations. These transformations are handled in the API by the ",(0,a.jsx)(n.code,{children:"SystemUpgrade"})," service, which is exposed via a Rake task in the API application."]}),"\n",(0,a.jsx)(n.h2,{id:"upgrade-instructions",children:"Upgrade Instructions"}),"\n",(0,a.jsx)(n.p,{children:"Follow the upgrade instructions that correspond to the type of Manifold installation you have."}),"\n",(0,a.jsx)(n.admonition,{type:"caution",children:(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Before upgrading, be sure to backup your installation by following our ",(0,a.jsx)(n.a,{href:"/manifold-docusaurus/docs/administering/backup_restore",children:"backup instructions"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["Please also consult the ",(0,a.jsx)(n.a,{href:"/manifold-docusaurus/docs/administering/release_notes/v6x",children:"release notes"})," for the version you're installing, in case there are manual upgrade steps that must be taken."]}),"\n",(0,a.jsx)(n.li,{children:"When a new version of Manifold is published, we test the upgrade process from the previous version. We cannot guarantee that upgrading across multiple major versions will work correctly, so always upgrade to the next major version."}),"\n"]})}),"\n",(0,a.jsx)(n.h3,{id:"for-a-package-install",children:"For a Package install"}),"\n",(0,a.jsxs)(n.p,{children:["To upgrade to a newer Manifold Omnibus package, begin by downloading and installing the package to your server. To do this, follow steps #1 and #2 of the  ",(0,a.jsx)(n.a,{href:"/manifold-docusaurus/docs/administering/installation#package-install",children:"package install instructions"})," for your operating system."]}),"\n",(0,a.jsxs)(n.admonition,{type:"tip",children:[(0,a.jsx)(n.p,{children:"To determine what version is installed, run this command on the host:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"cat /opt/manifold/embedded/src/MANIFOLD_VERSION ; echo\n"})})]}),"\n",(0,a.jsxs)(n.p,{children:["After you've installed the package, you should stop all services and reconfigure. Stop all Manifold services with ",(0,a.jsx)(n.code,{children:"manifold-ctl stop"}),". Then run ",(0,a.jsx)(n.code,{children:"manifold-ctl reconfigure"})," to ensure that all configuration is current. Once that\u2019s complete, you can restart the services with ",(0,a.jsx)(n.code,{children:"manifold-ctl start"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"/usr/bin/manifold-ctl stop\n/usr/bin/manifold-ctl reconfigure\n/usr/bin/manifold-ctl start\n"})}),"\n",(0,a.jsx)(n.p,{children:"Once this process is complete, visit the fully qualified domain name in your browser. Depending on the hosting environment, restarting Manifold can take a minute or two, so please be patient."}),"\n",(0,a.jsx)(n.h3,{id:"for-a-docker-install",children:"For a Docker install"}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"This section is still a work in progress. Check back soon for step-by-step instruction on managing upgrades in a Docker environment."})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var a=i(96540);const t={},s=a.createContext(t);function o(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);